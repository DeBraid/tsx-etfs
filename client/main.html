<head>
  <title>TSX Quotes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
</head>

<body>
  <!-- {{> yield "layout"}}   -->
</body>

<template name="layout">
  <div class="container">
    {{> welcome }}
    {{> lineChart }}
    {{> footer }}
  </div>
</template>

<template name="welcome">
  <div class="row">
   <div class="col-sm-12">
     <h1>TSX ETFs and Stocks</h1>
    <h4>by <a href="http://twitter.com/Royal_Arse">@Royal_Arse</a> of <a href="http://cacheflow.ca">cacheflow.ca</a></h4>
   </div> 
  </div>
</template>

<template name="lineChart">
  <div class="row">
    <div id="line-chart-container" class="col-sm-7">
      
      {{> tickerInfo }}

      <svg id="lineChart"></svg>

    </div>
    <div class="col-sm-5">    
      
      {{> waiting}}
      
      {{#with inputState }}
        <div class="input-group add-on {{ this.klass }}">
          <input type="text" class="form-control" placeholder="Enter ticker symbol" name="ticker" id="ticker-search">
          <div id="get-new-data" class="input-group-btn">
            <button class="btn btn-default" type="submit">
              <i class="glyphicon glyphicon-search"></i>
            </button>
          </div>
        </div>
      {{/with}}
    
      {{#with tickers }}      
        <h3>ETFs</h3>
        {{#each tickers.etfs}}
          {{> tickerList }}
        {{/each }}

        <h3>Stocks</h3>
        {{#each tickers.stocks}}
          {{> tickerList }}
        {{/each }}
      {{/with}}
    </div>
  </div>
</template>

<template name="waiting">
  {{#if waitingIs }}
    {{#if tryAgain }}
      {{> tickerNotFound }}
    {{ else }}
      {{> spinner}}
      <h5>Wait for it ... </h5>
    {{/if }}
  {{ else }}
    <h5>Type ticker symbol, hit enter:</h5>
  {{/if}}
</template>

<template name="tickerList">

  <button type="button" 
          id="{{ this }}" 
          class="ticker btn btn-xs btn-default ">
            {{ this }}
            <!-- <a href="{{pathFor 'chart' hash=this }}">{{ this }}</a> -->
  </button>
</template>

<template name="tickerInfo">
  {{#with tickerInfo }}
    {{#if tryAgain }}
      {{> tickerNotFound }}
    {{ else }}
      <h3 id="show-full-description" style="cursor:pointer;">{{ tickerInfo.name }}</h3>
        {{#if showFullDescription }}
          <p>{{ tickerInfo.description }}</p>
          <button id="hide-full-description" class="btn btn-xs btn-danger pull-left"> Hide </button>
          {{ else }}
          <button id="show-full-description" class="btn btn-xs btn-success pull-left">Show Description</button>          
        {{/if}}
    {{/if}}
  {{/with}}
</template>

<template name="tickerNotFound">
  <h3>Error: ticker not found.</h3>
</template>

<template name="footer">
  <div class="row">
    <p>Code on <a href="http://github.com/DeBraid/tsx-etfs">Github</a>.  Source: {{ tickerInfo.source }} via <a href="https://www.quandl.com" target="_blank">Quandl</a></p>
  </div>
</template>