<head>
  <title>TSX ETF and Stocks</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
</head>

<body>
  <div class="container">
    {{> welcome }}
    {{> lineChart }}
  </div>
</body>

<template name="welcome">
  <div class="row">
   <div class="col-sm-12">
     <h1>TSX ETFs and Stocks</h1>
    <h4>by <a href="http://twitter.com/Royal_Arse">@Royal_Arse</a> of <a href="http://cacheflow.ca">cacheflow.ca</a></h4>
    <p>Code on <a href="http://github.com/DeBraid/tsx-etfs">Github</a></p>
   </div> 
  </div>
</template>

<template name="lineChart">
  <div class="row">
    <div class="col-sm-7">
      
      <svg id="lineChart"></svg>
      
      {{> tickerInfo}}      

    </div>
    <div class="col-sm-5">    
      
      {{> waiting}}
      
      {{#with inputState }}
        <div class="input-group add-on {{ this.klass }}">
          <input type="text" class="form-control" placeholder="Enter ticker symbol" name="ticker" id="ticker-search">
          <div id="get-new-data" class="input-group-btn">
            <button class="btn btn-default" type="submit">
                  <i class="glyphicon glyphicon-search"></i>
              <!-- {{#if tryAgain }}
                  <i class="glyphicon glyphicon-search"></i>
                {{else}}
                  {{> spinner }}
              {{/if}} -->
            </button>
          </div>
        </div>
      {{/with}}
    
      {{#with tickers }}      
        <h3>ETFs</h3>
        {{#each tickers.etfs}}
          {{> tickerList }}
        {{/each }}

        <h3>Stocks</h3>
        {{#each tickers.stocks}}
          {{> tickerList }}
        {{/each }}
      {{/with}}
    </div>
  </div>
</template>

<template name="waiting">
  {{#if waitingIs }}
    {{#if tryAgain }}
      {{> tickerNotFound }}
    {{ else }}
      {{> spinner}}
      <h5>Wait for it ... </h5>
    {{/if }}
  {{ else }}
    <h5>Type ticker symbol, hit enter:</h5>
  {{/if}}
</template>

<template name="tickerList">
  <button type="button" 
          id="{{ this }}" 
          class="ticker btn btn-xs btn-default ">
            {{ this }}
  </button>
</template>

<template name="tickerInfo">
  {{#with tickerInfo }}
    {{#if tryAgain }}
      {{> tickerNotFound }}
    {{ else }}
      <h3>{{ tickerInfo.name }}</h3>
      <p>{{ tickerInfo.description }}</p>
      <aside>Source: {{ tickerInfo.source }} via <a href="https://www.quandl.com" target="_blank">Quandl</a></aside>
    {{/if}}
  {{/with}}
</template>

<template name="tickerNotFound">
  <h3>Error: ticker not found.</h3>
</template>